[gd_scene load_steps=9 format=3 uid="uid://sca2kqs0mfok"]

[ext_resource type="PackedScene" uid="uid://cfcer7aeaep8x" path="res://enemies/Enemy.tscn" id="1_ygql8"]
[ext_resource type="PackedScene" uid="uid://bw5l4rqeb3qt6" path="res://enemies/controllers/behaviors/variations/Chase.tscn" id="3_xfby1"]
[ext_resource type="PackedScene" uid="uid://b2enik8bjmhw5" path="res://enemies/common/VisionCone.tscn" id="4_f6j83"]
[ext_resource type="PackedScene" uid="uid://d26d7aod68kxw" path="res://enemies/controllers/behaviors/variations/Guard.tscn" id="4_ovycj"]
[ext_resource type="PackedScene" uid="uid://dqpa00kwayfee" path="res://enemies/controllers/behaviors/variations/InvestigateSound.tscn" id="5_lskpi"]
[ext_resource type="PackedScene" uid="uid://cgh7skii2sbu" path="res://attacking/AttackController.tscn" id="6_88ws8"]
[ext_resource type="Resource" uid="uid://b0dbl1c8gyv82" path="res://guns/Gun1.tres" id="7_mgpdn"]
[ext_resource type="PackedScene" uid="uid://nkgl2h57gbmc" path="res://common/SoundListener.tscn" id="8_6gljx"]

[node name="Basic" instance=ExtResource("1_ygql8")]

[node name="Controller" parent="." index="0"]
initial_state = "guard"

[node name="Chase" parent="Controller/Behaviors" index="0" node_paths=PackedStringArray("attack_controller") instance=ExtResource("3_xfby1")]
what = "enemy"
speed = 300.0
attack_range = 300.0
attack_controller = NodePath("../../../Sprite2D/AttackController")
on_lost = "investigate"
last_pos_var_name = "sound_area"
state = "chase"

[node name="Guard" parent="Controller/Behaviors" index="1" node_paths=PackedStringArray("sprite") instance=ExtResource("4_ovycj")]
sprite = NodePath("../../../Sprite2D")
on_spotted = "chase"
on_heard_sound = "investigate"
state = "guard"

[node name="InvestigateSound" parent="Controller/Behaviors" index="2" instance=ExtResource("5_lskpi")]
consider_reached_distance = 50.0
on_reached_point = "guard"
state = "investigate"

[node name="VisionCone" parent="Sprite2D" index="0" instance=ExtResource("4_f6j83")]
range = 800.0
look_for_group = "player"

[node name="AttackController" parent="Sprite2D" index="1" node_paths=PackedStringArray("rotation_controller") instance=ExtResource("6_88ws8")]
starting_gun = ExtResource("7_mgpdn")
rotation_controller = NodePath("..")
initial_total_ammo = 60

[node name="SoundListener" parent="." index="3" instance=ExtResource("8_6gljx")]

[connection signal="lost" from="Sprite2D/VisionCone" to="Controller/Behaviors/Chase" method="_on_vision_cone_lost"]
[connection signal="spotted" from="Sprite2D/VisionCone" to="Controller/Behaviors/Guard" method="_on_vision_cone_spotted"]
[connection signal="heard_sound" from="SoundListener" to="Controller/Behaviors/Guard" method="_on_sound_listener_heard_sound"]
[connection signal="heard_sound" from="SoundListener" to="Controller/Behaviors/InvestigateSound" method="_on_sound_listener_heard_sound"]

[editable path="Controller"]
[editable path="Sprite2D/AttackController"]
