[gd_scene load_steps=9 format=3 uid="uid://dxf6th6r4vs8s"]

[ext_resource type="PackedScene" uid="uid://cfcer7aeaep8x" path="res://enemies/Enemy.tscn" id="1_nc50y"]
[ext_resource type="Texture2D" uid="uid://8h2c4vsesupr" path="res://art/turret1.png" id="2_pgi6w"]
[ext_resource type="PackedScene" uid="uid://b7txw2bq7igc2" path="res://enemies/controllers/EnemyController.tscn" id="2_x5jbr"]
[ext_resource type="PackedScene" uid="uid://dcnujwx4a1qso" path="res://enemies/controllers/behaviors/variations/LookForEnemy.tscn" id="3_gr7tc"]
[ext_resource type="PackedScene" uid="uid://8m1veo8ognf3" path="res://enemies/controllers/behaviors/variations/LookAtEnemy.tscn" id="5_qe46v"]
[ext_resource type="PackedScene" uid="uid://cgh7skii2sbu" path="res://attacking/AttackController.tscn" id="6_vl3fw"]
[ext_resource type="Resource" uid="uid://b0dbl1c8gyv82" path="res://guns/Gun1.tres" id="7_aq118"]
[ext_resource type="PackedScene" uid="uid://nkgl2h57gbmc" path="res://common/SoundListener.tscn" id="8_2nu6a"]

[node name="Turret" instance=ExtResource("1_nc50y")]

[node name="Sprite2D" parent="." index="0"]
texture = ExtResource("2_pgi6w")

[node name="LaserPointerStart" type="Marker2D" parent="Sprite2D" index="0"]

[node name="Health" parent="." index="2"]
initial_value = 2
initial_max = 2

[node name="EnemyController" parent="." index="3" instance=ExtResource("2_x5jbr")]
initial_state = "look-for-enemy"

[node name="LookForEnemy" parent="EnemyController/Behaviors" index="0" node_paths=PackedStringArray("body", "laser_pointer_start") instance=ExtResource("3_gr7tc")]
turn_speed = 1.0
range = 1000.0
body = NodePath("../../..")
laser_pointer_start = NodePath("../../../Sprite2D/LaserPointerStart")
sound_track_turn_speed = 8.0
sound_track_duration = 2.0
state = "look-for-enemy"

[node name="LookAtEnemy" parent="EnemyController/Behaviors" index="1" node_paths=PackedStringArray("attack_controller", "body") instance=ExtResource("5_qe46v")]
attack_controller = NodePath("../../../AttackController")
body = NodePath("../../..")
lost_target_state = "look-for-enemy"
target_lost_timeout = 2.0
state = "look-at-enemy"

[node name="AttackController" parent="." index="4" node_paths=PackedStringArray("rotation_controller") instance=ExtResource("6_vl3fw")]
starting_gun = ExtResource("7_aq118")
rotation_controller = NodePath("..")
initial_total_ammo = 50

[node name="SoundListener" parent="." index="5" instance=ExtResource("8_2nu6a")]

[connection signal="found_target" from="EnemyController/Behaviors/LookForEnemy" to="EnemyController/Behaviors/LookAtEnemy" method="_on_look_for_enemy_found_target"]
[connection signal="lost_target" from="EnemyController/Behaviors/LookForEnemy" to="EnemyController/Behaviors/LookAtEnemy" method="_on_look_for_enemy_lost_target"]
[connection signal="heard_sound" from="SoundListener" to="EnemyController/Behaviors/LookForEnemy" method="_on_sound_listener_heard_sound"]

[editable path="EnemyController"]
