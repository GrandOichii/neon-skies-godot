[gd_scene load_steps=21 format=3 uid="uid://dxf6th6r4vs8s"]

[ext_resource type="PackedScene" uid="uid://cfcer7aeaep8x" path="res://enemies/Enemy.tscn" id="1_nc50y"]
[ext_resource type="Script" path="res://items/tables/LootTableRow.gd" id="2_3r8lf"]
[ext_resource type="Script" path="res://items/tables/LootTable.gd" id="2_8sr51"]
[ext_resource type="Script" path="res://items/variations/Credits.gd" id="2_cfgi1"]
[ext_resource type="Texture2D" uid="uid://8h2c4vsesupr" path="res://art/turret1.png" id="2_pgi6w"]
[ext_resource type="PackedScene" uid="uid://dcnujwx4a1qso" path="res://enemies/controllers/behaviors/variations/LookForEnemy.tscn" id="3_gr7tc"]
[ext_resource type="Script" path="res://items/variations/ImlantResource.gd" id="4_cyj5d"]
[ext_resource type="PackedScene" uid="uid://8m1veo8ognf3" path="res://enemies/controllers/behaviors/variations/LookAtEnemy.tscn" id="5_qe46v"]
[ext_resource type="PackedScene" uid="uid://cgh7skii2sbu" path="res://attacking/AttackController.tscn" id="6_vl3fw"]
[ext_resource type="Resource" uid="uid://b0dbl1c8gyv82" path="res://guns/Gun1.tres" id="7_aq118"]
[ext_resource type="PackedScene" uid="uid://nkgl2h57gbmc" path="res://common/SoundListener.tscn" id="8_2nu6a"]

[sub_resource type="Gradient" id="Gradient_wcoxc"]
colors = PackedColorArray(1, 0, 0, 1, 0, 1, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_ucsl0"]
gradient = SubResource("Gradient_wcoxc")
width = 16
height = 16

[sub_resource type="Resource" id="Resource_ibjgc"]
script = ExtResource("2_cfgi1")
from = 5
to = 10
texture = SubResource("GradientTexture2D_ucsl0")

[sub_resource type="Resource" id="Resource_tuv5y"]
script = ExtResource("2_3r8lf")
item = SubResource("Resource_ibjgc")
chance = 20

[sub_resource type="Gradient" id="Gradient_7v25n"]
colors = PackedColorArray(0, 0, 1, 1, 1, 0, 1, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_gaapw"]
gradient = SubResource("Gradient_7v25n")
width = 16
height = 16

[sub_resource type="Resource" id="Resource_y45wa"]
script = ExtResource("4_cyj5d")
from = 1
to = 1
texture = SubResource("GradientTexture2D_gaapw")

[sub_resource type="Resource" id="Resource_plpq3"]
script = ExtResource("2_3r8lf")
item = SubResource("Resource_y45wa")
chance = 30

[sub_resource type="Resource" id="Resource_1350l"]
script = ExtResource("2_8sr51")
chance_for_nothing = 5
rows = Array[ExtResource("2_3r8lf")]([SubResource("Resource_tuv5y"), SubResource("Resource_plpq3")])

[node name="Turret" instance=ExtResource("1_nc50y")]
drop_table = SubResource("Resource_1350l")

[node name="Controller" parent="." index="0"]
initial_state = "look-for-enemy"

[node name="LookForEnemy" parent="Controller/Behaviors" index="0" node_paths=PackedStringArray("body", "laser_pointer_start") instance=ExtResource("3_gr7tc")]
turn_speed = 1.0
range = 1000.0
body = NodePath("../../..")
laser_pointer_start = NodePath("../../../Sprite2D/LaserPointerStart")
sound_track_turn_speed = 8.0
sound_track_duration = 2.0
state = "look-for-enemy"

[node name="LookAtEnemy" parent="Controller/Behaviors" index="1" node_paths=PackedStringArray("attack_controller", "body") instance=ExtResource("5_qe46v")]
attack_controller = NodePath("../../../AttackController")
body = NodePath("../../..")
lost_target_state = "look-for-enemy"
target_lost_timeout = 2.0
state = "look-at-enemy"

[node name="Sprite2D" parent="." index="1"]
texture = ExtResource("2_pgi6w")

[node name="LaserPointerStart" type="Marker2D" parent="Sprite2D" index="0"]

[node name="AttackController" parent="." index="3" node_paths=PackedStringArray("rotation_controller") instance=ExtResource("6_vl3fw")]
starting_gun = ExtResource("7_aq118")
rotation_controller = NodePath("..")
initial_total_ammo = 50

[node name="SoundListener" parent="." index="4" instance=ExtResource("8_2nu6a")]

[connection signal="found_target" from="Controller/Behaviors/LookForEnemy" to="Controller/Behaviors/LookAtEnemy" method="_on_look_for_enemy_found_target"]
[connection signal="lost_target" from="Controller/Behaviors/LookForEnemy" to="Controller/Behaviors/LookAtEnemy" method="_on_look_for_enemy_lost_target"]
[connection signal="heard_sound" from="SoundListener" to="Controller/Behaviors/LookForEnemy" method="_on_sound_listener_heard_sound"]

[editable path="Controller"]
